(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{110:function(e,t,r){},145:function(e,t,r){"use strict";r.r(t);var a=r(0),n=r.n(a),c=r(15),s=r.n(c),i=(r(110),r(22)),o=r(14),u=r.n(o),l=r(196),j=r(42),b=r(197),d=r(92),O=Object(d.a)({typography:{fontFamily:"Open Sans, sans-serif",fontSize:14,button:{textTransform:"none",letterSpacing:0,fontWeight:"bold"}},overrides:{MuiInput:{input:{fontWeight:"bold"}}},palette:{primary:{main:"#3A8DFF"},secondary:{main:"#B0B0B0"}}}),p=r(23),h=r(12),x=r(32),f=r.n(x),m=r(18),v=r(181),g=r(71),y=r(184),w=r(148),k=r(185),C=r(151),S=r(2),F=function(e){var t=e.user,r=e.register,n=Object(m.f)(),c=Object(a.useState)({}),s=Object(h.a)(c,2),o=s[0],l=s[1],d=function(){var e=Object(i.a)(u.a.mark((function e(t){var a,n,c,s,i,o;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),a=t.currentTarget,n=a.elements,c=n.username.value,s=n.email.value,i=n.password.value,o=n.confirmPassword.value,i===o){e.next=10;break}return l({confirmPassword:"Passwords must match"}),e.abrupt("return");case 10:return e.next=12,r({username:c,email:s,password:i});case 12:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(a.useEffect)((function(){t&&t.id&&n.push("/")}),[t,n]),Object(S.jsx)(v.a,{container:!0,justifyContent:"center",children:Object(S.jsxs)(b.a,{children:[Object(S.jsxs)(v.a,{container:!0,item:!0,children:[Object(S.jsx)(g.a,{children:"Need to log in?"}),Object(S.jsx)(j.b,{href:"/login",to:"/login",children:Object(S.jsx)(y.a,{variant:"outlined",color:"primary",children:"Login"})})]}),Object(S.jsx)("form",{onSubmit:d,children:Object(S.jsxs)(v.a,{children:[Object(S.jsx)(v.a,{children:Object(S.jsx)(w.a,{children:Object(S.jsx)(k.a,{"aria-label":"username",label:"Username",name:"username",type:"text",required:!0})})}),Object(S.jsx)(v.a,{children:Object(S.jsx)(w.a,{children:Object(S.jsx)(k.a,{label:"E-mail address","aria-label":"e-mail address",type:"email",name:"email",required:!0})})}),Object(S.jsx)(v.a,{children:Object(S.jsxs)(w.a,{error:!!o.confirmPassword,children:[Object(S.jsx)(k.a,{"aria-label":"password",label:"Password",type:"password",inputProps:{minLength:6},name:"password",required:!0}),Object(S.jsx)(C.a,{children:o.confirmPassword})]})}),Object(S.jsx)(v.a,{children:Object(S.jsxs)(w.a,{error:!!o.confirmPassword,children:[Object(S.jsx)(k.a,{label:"Confirm Password","aria-label":"confirm password",type:"password",inputProps:{minLength:6},name:"confirmPassword",required:!0}),Object(S.jsx)(C.a,{children:o.confirmPassword})]})}),Object(S.jsx)(y.a,{type:"submit",variant:"outlined",color:"primary",size:"large",children:"Create"})]})})]})})},q=function(e){var t=e.user,r=e.login,n=Object(m.f)(),c=function(){var e=Object(i.a)(u.a.mark((function e(t){var a,n,c,s;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),a=t.currentTarget,n=a.elements,c=n.username.value,s=n.password.value,e.next=7,r({username:c,password:s});case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(a.useEffect)((function(){t&&t.id&&n.push("/")}),[t,n]),Object(S.jsx)(v.a,{container:!0,justifyContent:"center",children:Object(S.jsxs)(b.a,{children:[Object(S.jsxs)(v.a,{container:!0,item:!0,children:[Object(S.jsx)(g.a,{children:"Need to register?"}),Object(S.jsx)(j.b,{href:"/register",to:"/register",children:Object(S.jsx)(y.a,{variant:"outlined",color:"primary",children:"Register"})})]}),Object(S.jsx)("form",{onSubmit:c,children:Object(S.jsxs)(v.a,{children:[Object(S.jsx)(v.a,{children:Object(S.jsx)(w.a,{margin:"normal",required:!0,children:Object(S.jsx)(k.a,{"aria-label":"username",label:"Username",name:"username",type:"text"})})}),Object(S.jsx)(w.a,{margin:"normal",required:!0,children:Object(S.jsx)(k.a,{label:"password","aria-label":"password",type:"password",name:"password"})}),Object(S.jsx)(v.a,{children:Object(S.jsx)(y.a,{type:"submit",variant:"outlined",color:"primary",size:"large",children:"Login"})})]})})]})})},B=r(16),E=r(195),P=r(156),L=r(153),D=r(202),N=r(194),A=r(54),I=function(e){return{labels:Object.keys(e),datasets:[{data:Object.values(e),backgroundColor:["rgba(255, 99, 132, 1)","rgba(54, 162, 235, 1)","rgba(255, 206, 86, 1)","rgba(75, 192, 192, 1)","rgba(153, 102, 255, 1)","rgba(255, 159, 64, 1)"],hoverBackgroundColor:["rgba(255, 99, 132, 0.5)","rgba(54, 162, 235, 0.5)","rgba(255, 206, 86, 0.5)","rgba(75, 192, 192, 0.5)","rgba(153, 102, 255, 0.5)","rgba(255, 159, 64, 0.5)"]}]}},R=function(e){var t=e.data;return Object(S.jsxs)(S.Fragment,{children:[Object(S.jsx)("h3",{children:"Global Chart"}),Object(S.jsx)(b.a,{width:220,height:240,px:5,py:2,children:Object(S.jsx)(A.a,{data:I(t)})})]})},W=function(e){var t=e.data;return Object(S.jsxs)(S.Fragment,{children:[Object(S.jsx)("h3",{children:"Country Chart"}),Object(S.jsx)(b.a,{sx:{display:"flex",flexWrap:"wrap"},width:"100%",px:5,py:2,children:Object.entries(t).map((function(e,t){var r=Object(h.a)(e,2),a=r[0],n=r[1];return Object(S.jsxs)(b.a,{sx:{flexDirection:"column"},width:220,height:240,children:[a,Object(S.jsx)(A.a,{data:I(n)})]},t)}))})]})},T=function(e){var t=e.data;return Object(S.jsxs)(S.Fragment,{children:[Object(S.jsx)("h3",{children:"State Chart"}),Object(S.jsx)(b.a,{sx:{display:"flex",flexWrap:"wrap"},width:"100%",px:5,py:2,children:Object.entries(t).map((function(e,t){var r=Object(h.a)(e,2),a=r[0],n=r[1];return Object(S.jsxs)(b.a,{sx:{flexDirection:"column"},width:220,height:240,children:[a,Object(S.jsx)(A.a,{data:I(n)})]},t)}))})]})},z=function(e){var t=e.category,r=e.statistic;return Object(S.jsxs)(S.Fragment,{children:[Object(S.jsxs)("h2",{children:["Chart by ",t]}),Object(S.jsx)(b.a,{border:"1px solid #3A8DFF7F",p:3,my:2,children:r&&Object(S.jsxs)(S.Fragment,{children:[Object(S.jsx)(R,{data:r.global}),Object(S.jsx)(W,{data:r.country}),Object(S.jsx)(T,{data:r.state})]})})]})},U=function(e){var t=e.statistic;return Object(S.jsx)(S.Fragment,{children:t&&Object.entries(t).map((function(e,t){var r=Object(h.a)(e,2);return function(e,t,r){switch(e){case"byFemale":return Object(S.jsx)(z,{category:"Female",statistic:t},r);case"byLastName":return Object(S.jsx)(z,{category:"Last Name",statistic:t},r);case"byAge":return Object(S.jsx)(z,{category:"Age",statistic:t},r)}return""}(r[0],r[1],t)}))})},M=r(7),_=r(200),J=r(188),G=r(189),$=r(190),H=r(191),K=r(192),Q=r(198),V=r(193);function X(e){var t=e.requestData,r=Object(a.useState)(!1),n=Object(h.a)(r,2),c=n[0],s=n[1],i=Object(a.useState)({byFemale:!0,byLastName:!0,byAge:!0}),o=Object(h.a)(i,2),u=o[0],l=o[1],j=Object(a.useState)(!0),d=Object(h.a)(j,2),O=d[0],x=d[1];Object(a.useEffect)((function(){x(u.byAge|u.byFemale|u.byLastName)}),[u.byAge,u.byFemale,u.byLastName]);var f=function(){s(!1)},m=function(e){l(Object(p.a)(Object(p.a)({},u),{},Object(M.a)({},e.target.name,e.target.checked)))};return Object(S.jsxs)("div",{children:[Object(S.jsx)(y.a,{variant:"outlined",color:"primary",onClick:function(){s(!0)},children:"Request Data"}),Object(S.jsx)(_.a,{open:c,onClose:f,"aria-labelledby":"form-dialog-title",children:Object(S.jsxs)(b.a,{px:2,py:1,children:[Object(S.jsx)(J.a,{id:"form-dialog-title",children:"Request Form"}),Object(S.jsxs)(G.a,{children:[Object(S.jsx)($.a,{children:"Select necessary statistic types"}),Object(S.jsx)(b.a,{mx:2,children:Object(S.jsxs)(H.a,{children:[Object(S.jsx)(K.a,{control:Object(S.jsx)(Q.a,{checked:u.byFemale,onChange:m,name:"byFemale",color:"primary"}),label:"By female"}),Object(S.jsx)(K.a,{control:Object(S.jsx)(Q.a,{checked:u.byLastName,onChange:m,name:"byLastName",color:"primary"}),label:"By last name"}),Object(S.jsx)(K.a,{control:Object(S.jsx)(Q.a,{checked:u.byAge,onChange:m,name:"byAge",color:"primary"}),label:"By age"})]})})]}),Object(S.jsxs)(V.a,{children:[Object(S.jsx)(y.a,{onClick:f,color:"primary",children:"Cancel"}),Object(S.jsx)(y.a,{disabled:!O,onClick:function(){return s(!1),void t({desiredTypes:u})},color:"primary",children:"Request"})]})]})})]})}var Y=n.a.createContext(),Z=r(24);Z.d.register(Z.a,Z.l,Z.f);var ee=Object(N.a)((function(e){return{root:{display:"flex",flexDirection:"column"},formElement:{width:"30rem",margin:"1rem 2rem"}}})),te=function(e){var t=e.user,r=e.logout,n=Object(m.f)(),c=(Object(a.useContext)(Y),ee()),s=Object(a.useState)(!1),o=Object(h.a)(s,2),l=o[0],j=o[1],d=Object(a.useState)([]),O=Object(h.a)(d,2),p=O[0],x=O[1],v=Object(a.useState)(null),g=Object(h.a)(v,2),k=g[0],C=g[1],F=Object(a.useState)(""),q=Object(h.a)(F,2),N=q[0],A=q[1];Object(a.useEffect)((function(){null!==t&&void 0!==t&&t.isFetching||(t&&t.id?j(!0):l?n.push("/login"):n.push("/register"))}),[t,n,l]),Object(a.useEffect)((function(){var e=function(){var e=Object(i.a)(u.a.mark((function e(){var t,r;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,f.a.get("/api/requests");case 3:t=e.sent,r=t.data,A(r[0].id),x(r),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),console.error(e.t0);case 12:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(){return e.apply(this,arguments)}}();t.isFetching||e()}),[t]),Object(a.useEffect)(Object(i.a)(u.a.mark((function e(){var t,r;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f.a.get("/api/requests/".concat(N,"?format=json"));case 2:t=e.sent,r=t.data,C(r.statistic);case 5:case"end":return e.stop()}}),e)}))),[N]);var I=function(){var e=Object(i.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t||!t.id){e.next=3;break}return e.next=3,r(t.id);case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),R=function(){var e=Object(i.a)(u.a.mark((function e(t){var r,a,n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.desiredTypes,e.next=3,f.a.post("/api/requests/new",{desiredTypes:r});case 3:a=e.sent,n=a.data,x([n].concat(Object(B.a)(p))),A(n.id);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();function W(e,t){var r=new Blob([e]);if(window.navigator.msSaveOrOpenBlob)window.navigator.msSaveBlob(r,"filename.csv");else{var a=window.document.createElement("a");a.href=window.URL.createObjectURL(r,{type:"text/plain"}),a.download=t,document.body.appendChild(a),a.click(),document.body.removeChild(a)}}var T=function(){var e=Object(i.a)(u.a.mark((function e(t){var r,a,n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f.a.get("/api/requests/".concat(t,"?format=csv"));case 2:r=e.sent,a=r.data,n=p.find((function(e){return e.id===N})).created_at,W(a.join("\n"),"report-".concat(n.slice(0,10)," ").concat(n.slice(11,19),".csv"));case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(S.jsx)(E.a,{children:Object(S.jsxs)(b.a,{className:c.root,children:[Object(S.jsxs)(b.a,{sx:{display:"flex",justifyContent:"space-between"},children:[Object(S.jsxs)(b.a,{sx:{display:"flex"},children:[Object(S.jsx)(b.a,{mr:2,children:Object(S.jsx)(X,{requestData:R})}),Object(S.jsx)(b.a,{children:Object(S.jsx)(y.a,{variant:"outlined",color:"primary",onClick:function(){return T(N)},children:"Download"})})]}),Object(S.jsx)(b.a,{children:Object(S.jsx)(y.a,{variant:"outlined",color:"primary",onClick:I,children:"Logout"})})]}),Object(S.jsxs)(w.a,{className:c.formElement,children:[Object(S.jsx)(P.a,{id:"request-date",children:"Request Date"}),Object(S.jsx)(L.a,{id:"request-select",label:"Request Date",labelId:"request-date-id",value:N,onChange:function(e){A(e.target.value)},children:p.map((function(e){return Object(S.jsxs)(D.a,{value:e.id,children:[e.created_at.slice(0,10),"\xa0\xa0\xa0",e.created_at.slice(11,19)]},e.id)}))})]}),Object(S.jsx)(U,{statistic:k})]})})},re=r(201),ae=r(91),ne=r.n(ae),ce=Object(N.a)((function(e){return{snackbar:{backgroundColor:"red",fontWeight:"bold"},icon:{color:"white"}}})),se=function(e){var t=e.setSnackBarOpen,r=e.errorMessage,a=e.snackBarOpen,c=ce();return Object(S.jsx)(re.a,{open:a,onClose:function(){return t(!1)},message:r||"Sorry, an error occured. Please try again",action:Object(S.jsx)(n.a.Fragment,{children:Object(S.jsx)(y.a,{variant:"outlined",color:"primary",className:c.icon,size:"small",onClick:function(){return t(!1)},children:Object(S.jsx)(ne.a,{color:"secondary"})})}),ContentProps:{classes:{root:c.snackbar}}})},ie=Object(m.g)((function(e){var t=Object(a.useState)({isFetching:!0}),r=Object(h.a)(t,2),n=r[0],c=r[1],s=Object(a.useState)(""),o=Object(h.a)(s,2),l=o[0],j=o[1],b=Object(a.useState)(!1),d=Object(h.a)(b,2),O=d[0],x=d[1],v=function(){var e=Object(i.a)(u.a.mark((function e(t){var r,a;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,f.a.post("/auth/login",t);case 3:return r=e.sent,a=r.data,e.next=7,localStorage.setItem("statistic-token",a.token);case 7:c(a),e.next=14;break;case 10:e.prev=10,e.t0=e.catch(0),console.error(e.t0),c({error:e.t0.response.data.error||"Server Error"});case 14:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(t){return e.apply(this,arguments)}}(),g=function(){var e=Object(i.a)(u.a.mark((function e(t){var r,a;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,f.a.post("/auth/register",t);case 3:return r=e.sent,a=r.data,e.next=7,localStorage.setItem("statistic-token",a.token);case 7:c(a),e.next=14;break;case 10:e.prev=10,e.t0=e.catch(0),console.error(e.t0),c({error:e.t0.response.data.error||"Server Error"});case 14:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(t){return e.apply(this,arguments)}}(),y=function(){var e=Object(i.a)(u.a.mark((function e(t){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,f.a.delete("/auth/logout");case 3:return e.next=5,localStorage.removeItem("statistic-token");case 5:c({}),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),console.error(e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t){return e.apply(this,arguments)}}();return Object(a.useEffect)((function(){var e=function(){var e=Object(i.a)(u.a.mark((function e(){var t,r;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c((function(e){return Object(p.a)(Object(p.a)({},e),{},{isFetching:!0})})),e.prev=1,e.next=4,f.a.get("/auth/user");case 4:t=e.sent,r=t.data,c(r),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),console.error(e.t0);case 12:return e.prev=12,c((function(e){return Object(p.a)(Object(p.a)({},e),{},{isFetching:!1})})),e.finish(12);case 15:case"end":return e.stop()}}),e,null,[[1,9,12,15]])})));return function(){return e.apply(this,arguments)}}();e()}),[]),Object(a.useEffect)((function(){null!==n&&void 0!==n&&n.error&&("string"===typeof n.error?j(n.error):j("Internal Server Error. Please try again"),x(!0))}),[null===n||void 0===n?void 0:n.error]),null!==n&&void 0!==n&&n.isFetching?Object(S.jsx)("div",{children:"Loading..."}):Object(S.jsxs)(Y.Provider,{value:n,children:[O&&Object(S.jsx)(se,{setSnackBarOpen:x,errorMessage:l,snackBarOpen:O}),Object(S.jsxs)(m.c,{children:[Object(S.jsx)(m.a,{path:"/login",render:function(){return Object(S.jsx)(q,{user:n,login:v})}}),Object(S.jsx)(m.a,{path:"/register",render:function(){return Object(S.jsx)(F,{user:n,register:g})}}),Object(S.jsx)(m.a,{path:"/",render:function(e){return null!==n&&void 0!==n&&n.id?Object(S.jsx)(te,{user:n,logout:y}):Object(S.jsx)(F,{user:n,register:g})}})]})]})}));f.a.interceptors.request.use(function(){var e=Object(i.a)(u.a.mark((function e(t){var r;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,localStorage.getItem("statistic-token");case 2:return r=e.sent,t.headers["x-access-token"]=r,e.abrupt("return",t);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());var oe=function(){return Object(S.jsx)(l.a,{theme:O,children:Object(S.jsx)(j.a,{children:Object(S.jsx)(b.a,{my:3,children:Object(S.jsx)(ie,{})})})})};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));s.a.render(Object(S.jsx)(oe,{}),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[145,1,2]]]);
//# sourceMappingURL=main.7eb99532.chunk.js.map